<!DOCTYPE html>
<html lang="en-GB">

<head>
	<meta charset=utf-8 />
	<title>NostraDavid's Knowledge Base - Javascript code snippets and regex | The Thaumatorium</title>
	<meta name=description content="Little snippets of information. Usually Javascript or Regex, though I may expand this" />
	<meta name=theme-color content=#800 />
	<link rel=apple-touch-icon href=/images/icons-192.png>
	<meta name=viewport content="width=device-width, initial-scale=1">
	<link rel=manifest href=/manifest.json />
	<link rel=icon href=/images/favicon.svg />
	<link rel=preload href=/styles/main.css as=style onload="this.rel='stylesheet';this.onload=null">
	<noscript>
		<link rel=stylesheet href="/styles/main.css" />
	</noscript>
</head>

<body>
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169207994-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());
		gtag('config', 'UA-169207994-1');
	</script>

	<header>
		<div class=title>The Thaumatorium:</div>
		<div class=subtitle>Where the magic happens</div>
	</header>

	<nav role=navigation>
		<a href="/">Frontpage</a><span> - </span>
		<a href=/articles>Articles</a><span> - </span>
		<a href=/projects.html>Projects</a><span> - </span>
		<a href=/experimentations.html>Experimentations</a><span> - </span>
		<a href=/code-of-conduct.html>Code of Conduct</a><span> - </span>
		<a href=/random-video.html>Random video</a><span> - </span>
		<a href=/hardware.html>Hardware</a><span> - </span>
		<a href=/knowledge-base.html>Knowledge Base</a><span> - </span>
		<a href=/about.html>About</a>
	</nav>

	<main>
		<h1>NostraDavid's Knowledge Base - Javascript code snippets and regex</h1>
		<p>For now (<time>2020-07-16</time>) it's just snippets of JS and regex that I use every now and then</p>
		<p>I'd use GitHub for that, but I have a tendency to forget <a href="https://gist.github.com/NostraDavid">GitHub Gist</a> exists…</p>

		<div>
			<button class=button type=button onclick="document.querySelectorAll(`details`).forEach(el => {el.open = true});">Open all chapters</button>
			<button class=button type=button onclick="document.querySelectorAll(`details`).forEach(el => {el.open = false});">Close all chapters</button>
		</div>

		<details>
			<summary>
				<h2>Online Tools</h2>
				<p>These are websites/webpages that I use to optimize this site.</p>
			</summary>

			<table>
				<thead>
					<th>Tool name</th>
					<th>What to use it for</th>
				</thead>
				<tbody>
					<tr>
						<td><a href="https://jakearchibald.github.io/svgomg/">SVGOMG!</a></td>
						<td>"<a href="https://github.com/svg/svgo"><b>SVG O</b>ptimizer</a>'s <b>M</b>issing <b>G</b>UI", an online SVG optimizer </td>
					</tr>
					<tr>
						<td><a href="https://closure-compiler.appspot.com/home">Google's Closure Compiler</a></td>
						<td>A Javascript optimizer - turns modern JS into highly optimized, yet compatible, Javascript. I use this to improve my JS code here and there.</td>
					</tr>
					<tr>
						<td><a href="https://www.mysitemapgenerator.com/">My Sitemap Generator</a></td>
						<td>Since this is a fully static site I have to update the sitemap manually. I use this site to automate the generation partially.</td>
					</tr>
					<tr>
						<td><a href="https://boxy-svg.com/app/">Boxy SVG editor</a></td>
						<td>Usually I edit my SVG files by hand, but sometimes I need some basic shapes placed.</td>
					</tr>
					<tr>
						<td><a href="https://www.bing.com/webmasters/robotstxttester">Bing's robot.txt Tester</a></td>
						<td>Use this to check your robots.txt for faults.</td>
					</tr>
					<tr>
						<td><a href="https://squoosh.app/">Squoosh</a></td>
						<td>Google Chrome Labs created this site so you can customize the compression of your image (and compare it with the original). <a href="https://squoosh-desktop.now.sh/">Desktop version</a> is also available.</td>
					</tr>
					<tr>
						<td><a href="https://app.diagrams.net/">Diagrams.net</a> (previously Draw.io)</td>
						<td>Used for diagrams. If you save a file as PNG you can open it as PNG with an image viewer <em>and</em> and with the website or <a href="https://github.com/jgraph/drawio-desktop/releases/tag/v13.6.2">Desktop version</a></td>
					</tr>
				</tbody>
			</table>
		</details>

		<details>
			<summary>
				<h2>Javascript oneliners</h2>
				<p>Small scripts that I run in the browser to manipulate a website (like remove my reddit comments from a specific subreddit, for example)</p>
			</summary>
			<table>
				<tbody>
					<tr>
						<th>note</th>
						<th>code</th>
					</tr>
					<tr>
						<td>Open all collapsed comments on a reddit comment page</td>
						<td>
							<pre><code class=lang-javascript>document.querySelectorAll(".expand")
				.forEach(el => {
					if (el.innerText == "[+]") {
						el.click();
					}
				});</code></pre>
						</td>
					</tr>
					<tr>
						<td>Manipulating Unicode strings per code point, not per byte. <code class=lang-javascript>"".split()</code> gives you bytes, not codepoints</td>
						<td><code class=lang-javascript>Array.from("𝔱𝔢𝔰𝔱𝔦𝔫𝔤 𝔗𝔈𝔖𝔗 #@$%#^$% 𝔱𝔢𝔰𝔱𝔦𝔫𝔤 𝔗𝔈𝔖𝔗");</code></td>
					</tr>
					<tr>
						<td>Remove all <code class=lang-css>.bighead</code> classed elements (no Array.from() needed, which is what I used before, so I could use map() instead of a for loop)</td>
						<td>
							<pre><code class=lang-javascript>document.querySelectorAll(".bighead")
				.forEach(el => {
					el.parentElement
						.removeChild(el)
					});</code></pre>
						</td>
					</tr>
					<tr>
						<td>Make console.log use colors</td>
						<td>
							<pre><code class=lang-javascript>const CONSOLE_STYLE = "background: #800; color: #fff; padding: 2px";
console.log('%cService worker installing', CONSOLE_STYLE);</code></pre>
						</td>
					</tr>
					<tr>
						<td>This opens all <samp>are you sure?</samp> dialogs for comments, on a profile page of Reddit</td>
						<td>
							<pre><code class=lang-javascript>let ys = Array.from(document.getElementsByClassName("score likes"))
							.filter(e => parseInt(e.title) < 3)
							.map(e => e.parentElement.parentElement.parentElement)
							.map(el => el.querySelector(`[data-event-action*="delete"]`));
// pick everything after the 77th comment
ys = ys.slice(77, ys.length - 1);
ys.map(e => e.click());</code></pre>
						</td>
					</tr>
					<tr>
						<td>Removing duplicates</td>
						<td>
							<pre><code class=lang-javascript>const cities = ["Den Haag","Den Haag",
								"Utrecht", "Utrecht",
								"Arnhem", "Arnhem",
								"MiddelBurg", "MiddelBurg",
								"MiddelBurg"];
const uniqueCities = [...new Set(cities)];
// ["Den Haag", "Utrecht", "Arnhem", "MiddelBurg"]</code></pre>
						</td>
					</tr>
					<tr>
						<td>Run a timed loop (handy for interacting with Reddit, because Reddit has a rate limit of 30 requests per minute)</td>
						<td>
							<pre><code class=lang-javascript>let xs = document.querySelectorAll("[query goes here]");
let i = 0;
let id = setInterval(() => {console.log(i); xs[i].click(); i++;}, 1100);
clearInterval(id);</code></pre>
						</td>
					</tr>
					<tr>
						<td> Remove all comments from a specific subreddit (TheLastOfUs2, in this case)</td>
						<td>
							<pre><code class=lang-javascript>Array.from(document.getElementsByClassName("subreddit hover"))
									 .filter(el => el.innerHTML == "TheLastOfUs2")
									 .map(el => el.parentElement.parentElement)
									 .map(el => {
										 // subselection apparently works
										 el.querySelector(`[data-event-action*="delete"]`)
									 })
									 .map(el => el.click());</code></pre>
						</td>
					</tr>
					<tr>
						<td>Use on Twitch to track the amount of currently used emotes</td>
						<td>
							<pre><code class=lang-javascript>const groupBy = (xs, key) => xs.reduce((acc, x) => {
	(acc[x[key]] = acc[x[key]] || []).push(x);
	return acc;
}, {});

let emoticons = Array.from(document.querySelectorAll(`.chat-line__message--emote[alt]`));
let groupedEmoticons = groupBy(emoticons, 'alt');
let listedEmoticons = [];

for (const key in groupedEmoticons) {
	if (groupedEmoticons.hasOwnProperty(key)) {
		const el = groupedEmoticons[key];
		listedEmoticons.push({key: key, length: el.length});
	}
}

listedEmoticons.sort((a, b) => b.length - a.length)
							 .slice(0,6)
							 .sort((a, b) => a.length - b.length)
							 .reduce((acc, el) => `${el.length}x ${el.key} ` + acc);</code></pre>
						</td>
					</tr>
				</tbody>
			</table>
		</details>

		<details>
			<summary>
				<h2>Regular Expressions</h2>
				<p>Use in combination with $0/$1/$2... to find and replace text.</p>
			</summary>
			<table>
				<thead>
					<tr>
						<th>note </th>
						<th>regex </th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Find the nth comma, via <a href="https://stackoverflow.com/a/9194889/1102369">stackoverflow</a>;<br> Edit the number in between {} to find the nth comma.</td>
						<td><code class=lang-regex>,(?=(?:[^,]*,){3}[^,]*$)</code></td>
					</tr>
					</tr>
					<tr>
						<td>Every line that doesn't start with a <samp>.</samp> via regex;<br>I was trying to filter bootstrap.css from all non-classes</td>
						<td><code class=lang-regex>^((?!^\.).)*$</code></td>
					</tr>
					<tr>
						<td>Filter everything from a : till the end of the line</td>
						<td><code class=lang-regex>[:].*$</code></td>
					</tr>
					<tr>
						<td>Find non-ASCII letters in vscode;<br>Great for finding unicode characters in copied code, because Haskell can't handle Unicode in your comments...</td>
						<td><code class=lang-regex>([^\x00-\x7F])</code></td>
					</tr>
					<tr>
						<td>hit him up when you pay for WoW</td>
						<td>Craizler-TarrenMill</td>
					</tr>
					<tr>
						<td>WoW BattleTag</td>
						<td>Cyrstad#2776</td>
					</tr>
					<tr>
						<td>Find main content of HTML page</td>
						<td><code class=lang-regex>&lt;main&gt;\n\t+&lt;section&gt;((\n.*?)*)&lt;/section&gt;(\n\t+)&lt;/main&gt;</code></td>
					</tr>
					<tr>
						<td>find paragraph tags that aren't closed</td>
						<td><code class=lang-regex>\t+&lt;p&gt;.*(?&lt;!&lt;/p&gt;)$</code></td>
					</tr>
				</tbody>
			</table>
		</details>

		<details>
			<summary>
				<h2>National 'warcry'</h2>
				<p>Twitch sillyness</p>
			</summary>
			<p>Not really a 'warcry', but whenever anyone posts any of these terms other nationals will join in repeating it.</p>
			<p>PS: Sometimes it's just an emote spam</p>
			<table>
				<thead>
					<tr>
						<th>Country</th>
						<th>Warcry</th>
					</tr>
				</thead>
				<tbody>

					<tr>
						<td>Dutch</td>
						<td>G E K O L O N I S E E R D</td>
					</tr>
					<tr>
						<td>German</td>
						<td>Sprich Deutsch, du Hurensohn!</td>
					</tr>
					<tr>
						<td>Swedish</td>
						<td>Skååååål</td>
					</tr>
					<tr>
						<td>Danish</td>
						<td>Skååååål</td>
					</tr>
					<tr>
						<td>Finnish</td>
						<td>Torille!</td>
					</tr>
					<tr>
						<td>Bulgarian</td>
						<td><a href="https://cdn.betterttv.net/emote/56be9fd6d9ec6bf74424760d/3x">KKomrade</a></td>
					</tr>
					<tr>
						<td>Germany</td>
						<td><a href="https://static-cdn.jtvnw.net/emoticons/v1/111700/3.0">DatScheffe</a></td>
				</tbody>
			</table>
		</details>

		<details>
			<summary>
				<h2>Information for a secret project</h2>
				<p>I can't show you yet. I'm halfway, but its important it's done.</p>
			</summary>
			<table>
				<tr>
					<th>Character</th>
					<th>HTML code</th>
				</tr>
				<tr>
					<td>𝑥</td>
					<td><code class=lang-html>&amp;#119909;</code></td>
				</tr>
				<tr>
					<td>ə</td>
					<td><code class=lang-html>&amp;#601;</code></td>
				</tr>
				<tr>
					<td>α</td>
					<td><code class=lang-html>&amp;alpha;</code></td>
				</tr>
				<tr>
					<td>β</td>
					<td><code class=lang-html>&amp;beta;</code></td>
				</tr>
				<tr>
					<td>𝔟</td>
					<td><code class=lang-html>&amp;bfr;</code></td>
				</tr>
				<tr>
					<td>𝔅</td>
					<td><code class=lang-html>&amp;Bfr;</code></td>
				</tr>
				<tr>
					<td>𝔠</td>
					<td><code class=lang-html>&amp;cfr;</code></td>
				</tr>
				<tr>
					<td>ℭ</td>
					<td><code class=lang-html>&amp;Cfr;</code></td>
				</tr>
				<tr>
					<td>†</td>
					<td><code class=lang-html>&amp;dagger;</code></td>
				</tr>
				<tr>
					<td>‡</td>
					<td><code class=lang-html>&amp;ddagger;</code></td>
				</tr>
				<tr>
					<td>𝔢</td>
					<td><code class=lang-html>&amp;efr;</code></td>
				</tr>
				<tr>
					<td>𝔈</td>
					<td><code class=lang-html>&amp;Efr;</code></td>
				</tr>
				<tr>
					<td>=</td>
					<td><code class=lang-html>&amp;equals;</code></td>
				</tr>
				<tr>
					<td>𝔣</td>
					<td><code class=lang-html>&amp;ffr;</code></td>
				</tr>
				<tr>
					<td>γ</td>
					<td><code class=lang-html>&amp;gamma;</code></td>
				</tr>
				<tr>
					<td>…</td>
					<td><code class=lang-html>&amp;hellip;</code></td>
				</tr>
				<tr>
					<td>𝔨</td>
					<td><code class=lang-html>&amp;kfr;</code></td>
				</tr>
				<tr>
					<td>𝔩</td>
					<td><code class=lang-html>&amp;lfr;</code></td>
				</tr>
				<tr>
					<td>ℳ</td>
					<td><code class=lang-html>&amp;Mscr;</code></td>
				</tr>
				<tr>
					<td></td>
					<td><code class=lang-html>&amp;nbsp;</code></td>
				</tr>
				<tr>
					<td>𝔬</td>
					<td><code class=lang-html>&amp;ofr;</code></td>
				</tr>
				<tr>
					<td>ö</td>
					<td><code class=lang-html>&amp;ouml;</code></td>
				</tr>
				<tr>
					<td>𝔭</td>
					<td><code class=lang-html>&amp;pfr;</code></td>
				</tr>
				<tr>
					<td>′</td>
					<td><code class=lang-html>&amp;prime;</code></td>
				</tr>
				<tr>
					<td>𝔮</td>
					<td><code class=lang-html>&amp;qfr;</code></td>
				</tr>
				<tr>
					<td>→</td>
					<td><code class=lang-html>&amp;rarr;</code></td>
				</tr>
				<tr>
					<td>𝔯</td>
					<td><code class=lang-html>&amp;rfr;</code></td>
				</tr>
				<tr>
					<td>§</td>
					<td><code class=lang-html>&amp;sect;</code></td>
				</tr>
				<tr>
					<td>𝔘</td>
					<td><code class=lang-html>&amp;Ufr;</code></td>
				</tr>
				<tr>
					<td>𝒰</td>
					<td><code class=lang-html>&amp;Uscr;</code></td>
				</tr>
				<tr>
					<td>Ü</td>
					<td><code class=lang-html>&amp;Uuml;</code></td>
				</tr>
				<tr>
					<td>“</td>
					<td><code class=lang-html>&amp;OpenCurlyDoubleQuote;</code></td>
				</tr>
				<tr>
					<td>”</td>
					<td><code class=lang-html>&amp;CloseCurlyDoubleQuote;</code></td>
				</tr>
				<tr>
					<td>π</td>
					<td><code class=lang-html>&amp;pi;</code></td>
				</tr>
			</table>
		</details>
	</main>

	<footer>
		<div class=copyright>
			©<a href="https://www.youtube.com/watch?v=czgOWmtGVGs" style="text-decoration: none; color: #800;">12019</a>
			– <a id=target-year href="http://updateyourfooter.com/" style="text-decoration: none; color: #800;">120__</a>,
			<abbr title="Copyright is implicit, almost anywhere in the world! If you want to know more, wikipedia 'Berne Convention'" style="text-decoration: none; color: #800;">Thaumatorium</abbr>
			<p><sub>Last updated: <time id=updated>2020-__-__</time></sub></p>
		</div>
		<nav id=profiles>
			<p>Media profiles</p>
			<a href="https://www.reddit.com/user/nostradavid"><img src="/images/social-media/reddit.svg" alt="Snoo, Reddit's logo" width=32 height=32></a><span> - </span>
			<a href="https://twitter.com/DavidNostra"><img src="/images/social-media/twitter.svg" alt="Twitter's logo" width=32 height=32></a><span> - </span>
			<a href="https://github.com/NostraDavid"><img src="/images/social-media/github.svg" alt="Twitter's logo" width=32 height=32>(me)</a><span> - </span>
			<a href="https://github.com/Thaumatorium"><img src="/images/social-media/github.svg" alt="Twitter's logo" width=32 height=32>(pro)</a><span> - </span>
			<a href="https://www.facebook.com/david.nostra.121"><img src="/images/social-media/facebook.svg" alt="Twitter's logo" width=32 height=32></a>
		</nav>
		<!-- Sssh - don't tell anyone! -->
		<a class=secret onclick=specialGoto(event)>π</a>
		<div id=cookie-notification>
			<p>This site uses cookies from Google to deliver its services and to analyze traffic. <button>OK</button></p>
		</div>
	</footer>
	<script async src=/pwa.js></script>
</body>

</html>